# Toast App ë°ì´í„° ì €ì¥ì†Œ ìŠ¤í‚¤ë§ˆ

ì´ ë¬¸ì„œëŠ” Toast Appì˜ ë°ì´í„° ì €ì¥ì†Œ ìŠ¤í‚¤ë§ˆ, ê´€ê³„ ë° êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

## ëª©ì°¨

- [Toast App ë°ì´í„° ì €ì¥ì†Œ ìŠ¤í‚¤ë§ˆ](#toast-app-ë°ì´í„°-ì €ì¥ì†Œ-ìŠ¤í‚¤ë§ˆ)
  - [ëª©ì°¨](#ëª©ì°¨)
  - [ê°œìš”](#ê°œìš”)
  - [ì €ì¥ì†Œ êµ¬í˜„](#ì €ì¥ì†Œ-êµ¬í˜„)
  - [ìŠ¤í‚¤ë§ˆ êµ¬ì¡°](#ìŠ¤í‚¤ë§ˆ-êµ¬ì¡°)
    - [ë©”ì¸ êµ¬ì„± ì €ì¥ì†Œ](#ë©”ì¸-êµ¬ì„±-ì €ì¥ì†Œ)
    - [ì‚¬ìš©ì ë°ì´í„° ê´€ë¦¬](#ì‚¬ìš©ì-ë°ì´í„°-ê´€ë¦¬)
  - [ì—”í‹°í‹° ê´€ê³„](#ì—”í‹°í‹°-ê´€ê³„)
  - [ì£¼ìš” ì—”í‹°í‹°](#ì£¼ìš”-ì—”í‹°í‹°)
    - [ì „ì—­ ì„¤ì •](#ì „ì—­-ì„¤ì •)
    - [í˜ì´ì§€](#í˜ì´ì§€)
    - [ë²„íŠ¼](#ë²„íŠ¼)
    - [ì‚¬ìš©ì ê³„ì •](#ì‚¬ìš©ì-ê³„ì •)
    - [ë™ê¸°í™” ë©”íƒ€ë°ì´í„°](#ë™ê¸°í™”-ë©”íƒ€ë°ì´í„°)
  - [í•„ë“œ ì„¤ëª…](#í•„ë“œ-ì„¤ëª…)
    - [ì „ì—­ ì„¤ì • í•„ë“œ](#ì „ì—­-ì„¤ì •-í•„ë“œ)
    - [í˜ì´ì§€ í•„ë“œ](#í˜ì´ì§€-í•„ë“œ)
    - [ë²„íŠ¼ í•„ë“œ](#ë²„íŠ¼-í•„ë“œ)
    - [ì‚¬ìš©ì ê³„ì • í•„ë“œ](#ì‚¬ìš©ì-ê³„ì •-í•„ë“œ)
    - [ë™ê¸°í™” ë©”íƒ€ë°ì´í„° í•„ë“œ](#ë™ê¸°í™”-ë©”íƒ€ë°ì´í„°-í•„ë“œ)
  - [ì¸ë±ì‹±](#ì¸ë±ì‹±)
  - [ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜](#ë°ì´í„°-ë§ˆì´ê·¸ë ˆì´ì…˜)
  - [ë°±ì—… ë° ë³µêµ¬](#ë°±ì—…-ë°-ë³µêµ¬)
  - [ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­](#ì„±ëŠ¥-ê³ ë ¤ì‚¬í•­)
  - [ìŠ¤í‚¤ë§ˆ ë²„ì „ ê´€ë¦¬](#ìŠ¤í‚¤ë§ˆ-ë²„ì „-ê´€ë¦¬)

## ê°œìš”

Toast Appì€ ì „í†µì ì¸ ë°ì´í„°ë² ì´ìŠ¤ ëŒ€ì‹  íŒŒì¼ ê¸°ë°˜ ì €ì¥ì†Œ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ë°ì´í„°ëŠ” `electron-store` íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ JSON í˜•ì‹ìœ¼ë¡œ ì €ì¥ë˜ë©°, ì´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë°ì´í„°ë¥¼ ì§€ì†ì ìœ¼ë¡œ ì €ì¥í•˜ê³  ê²€ìƒ‰í•˜ëŠ” ê°„ë‹¨í•˜ê³  íš¨ìœ¨ì ì¸ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.

## ì €ì¥ì†Œ êµ¬í˜„

ì•±ì€ ë‹¤ìŒê³¼ ê°™ì€ ì €ì¥ì†Œ êµ¬ì„± ìš”ì†Œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:

1. **ë©”ì¸ êµ¬ì„± ì €ì¥ì†Œ**: ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •, ë²„íŠ¼ êµ¬ì„± ë° í˜ì´ì§€ ë ˆì´ì•„ì›ƒì„ ì²˜ë¦¬í•˜ëŠ” ë‹¨ì¼ `electron-store` ì¸ìŠ¤í„´ìŠ¤
2. **ì‚¬ìš©ì ë°ì´í„° ê´€ë¦¬**: ì‚¬ìš©ì ê³„ì • ì •ë³´ì™€ ì¸ì¦ í† í°ì„ ë³„ë„ íŒŒì¼ë¡œ ê´€ë¦¬
3. **ì„ì‹œ ë°ì´í„°**: ë©”ëª¨ë¦¬ ë‚´ ìºì‹± ë° ì„ì‹œ ìƒíƒœ ê´€ë¦¬

ì£¼ìš” ì €ì¥ì†ŒëŠ” `src/main/config.js`ì—ì„œ ìŠ¤í‚¤ë§ˆ ê²€ì¦ê³¼ í•¨ê»˜ ë‹¨ì¼ `electron-store` ì¸ìŠ¤í„´ìŠ¤ë¡œ êµ¬í˜„ë©ë‹ˆë‹¤.

## ìŠ¤í‚¤ë§ˆ êµ¬ì¡°

### ë©”ì¸ êµ¬ì„± ì €ì¥ì†Œ

ë©”ì¸ êµ¬ì„± ì €ì¥ì†ŒëŠ” í•µì‹¬ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì„±ì„ í¬í•¨í•˜ë©° ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±ë©ë‹ˆë‹¤:

```json
{
  "globalHotkey": "Alt+Space",
  "pages": [
    {
      "name": "Main",
      "shortcut": "1",
      "buttons": [
        {
          "name": "Files",
          "shortcut": "Q",
          "icon": "ğŸ“",
          "action": "open",
          "url": "/Users/username/Documents"
        }
      ]
    }
  ],
  "appearance": {
    "theme": "system",
    "position": "center",
    "size": "medium",
    "opacity": 0.95,
    "buttonLayout": "grid",
    "monitorPositions": {}
  },
  "advanced": {
    "launchAtLogin": false,
    "hideAfterAction": true,
    "hideOnBlur": true,
    "hideOnEscape": true,
    "showInTaskbar": false
  },
  "subscription": {
    "isSubscribed": false,
    "isAuthenticated": false,
    "expiresAt": "",
    "pageGroups": 1
  },
  "firstLaunchCompleted": false
}
```

### ì‚¬ìš©ì ë°ì´í„° ê´€ë¦¬

ì‚¬ìš©ì ë°ì´í„°ëŠ” ë³„ë„ íŒŒì¼ë“¤ë¡œ ê´€ë¦¬ë˜ë©° ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì§‘ë‹ˆë‹¤:

**ì¸ì¦ í† í° íŒŒì¼** (`user-data-manager.js`ì—ì„œ ê´€ë¦¬):
```json
{
  "accessToken": "encrypted_access_token",
  "refreshToken": "encrypted_refresh_token",
  "expiresAt": "2024-06-16T10:30:45Z"
}
```

**ì‚¬ìš©ì í”„ë¡œí•„ ë°ì´í„°** (ë©”ëª¨ë¦¬ ë‚´ ìºì‹±):
```json
{
  "id": "user_123456",
  "email": "user@example.com",
  "subscription": {
    "level": "premium",
    "expiresAt": "2024-12-31T23:59:59Z"
  },
  "lastLogin": "2024-06-15T10:30:45Z"
}
```

## Entity Relationships

The primary entities in Toast App have the following relationships:

1. **User** (1) â†’ (n) **Pages**: A user can have multiple pages
2. **Page** (1) â†’ (n) **Buttons**: A page can contain multiple buttons
3. **User** (1) â†’ (1) **Settings**: A user has one set of settings
4. **User** (1) â†’ (1) **SyncMetadata**: A user has one sync metadata record

## Key Entities

### Global Settings

Global settings control the application's behavior and appearance. These include:

- Global hotkey configuration
- UI preferences (theme, position, size, opacity)
- Window management behavior
- Startup configuration
- Layout preferences

### Pages

Pages organize buttons into logical groups. Each page has:

- Unique identifier
- Name
- Shortcut key (1-9)
- Associated buttons
- Sort order

### Buttons

Buttons are the primary interactive elements in Toast App. Each button has:

- Unique identifier
- Name
- Display icon (emoji or custom)
- Shortcut key
- Action type (exec, open, script, shortcut, chain)
- Action parameters (specific to action type)
- Parent page reference

### User Account

The user account entity stores authentication and subscription information:

- User identifier
- Email address
- Subscription level and expiration
- Authentication tokens (encrypted)
- Last login timestamp

### Sync Metadata

Sync metadata tracks information about cloud synchronization:

- Last sync timestamp
- Sync status
- Device identifier
- Change history
- Conflict resolution data

## Field Descriptions

### Global Settings Fields

| Field | Type | Description | Default |
|-------|------|-------------|---------|
| globalHotkey | String | Global keyboard shortcut to open Toast window | "Alt+Space" |
| appearance.theme | String | UI theme ("light", "dark", or "system") | "system" |
| appearance.position | String | Toast window position ("center", "top", "bottom", "cursor") | "center" |
| appearance.size | String | Toast window size ("small", "medium", "large") | "medium" |
| appearance.opacity | Number | Toast window opacity (0.0-1.0) | 0.95 |
| appearance.buttonLayout | String | Button layout style ("grid" or "list") | "grid" |
| advanced.launchAtLogin | Boolean | Whether to launch the app on system login | false |
| advanced.hideAfterAction | Boolean | Whether to hide window after action execution | true |
| advanced.hideOnBlur | Boolean | Whether to hide window when it loses focus | true |
| advanced.hideOnEscape | Boolean | Whether to hide window when Escape is pressed | true |
| advanced.showInTaskbar | Boolean | Whether to show window in taskbar/dock | false |

### Page Fields

| Field | Type | Description |
|-------|------|-------------|
| id | String | Unique identifier for the page |
| name | String | Display name for the page |
| shortcut | String | Number key (1-9) to switch to this page |
| buttons | Array | Collection of button objects on this page |
| sortOrder | Number | Position in the page list (optional) |

### Button Fields

| Field | Type | Description |
|-------|------|-------------|
| id | String | Unique identifier for the button |
| name | String | Display name for the button |
| shortcut | String | Single character shortcut for the button |
| icon | String | Emoji or icon reference for the button |
| actionType | String | Type of action ("exec", "open", "script", "shortcut", "chain") |
| actionParams | Object | Parameters specific to the action type |
| enabled | Boolean | Whether the button is enabled (optional) |

### User Account Fields

| Field | Type | Description |
|-------|------|-------------|
| id | String | Unique identifier for the user |
| email | String | User's email address |
| subscription.level | String | Subscription level ("free", "basic", "premium") |
| subscription.expiresAt | String | Subscription expiration date (ISO format) |
| lastLogin | String | Last login timestamp (ISO format) |

### Sync Metadata Fields

| Field | Type | Description |
|-------|------|-------------|
| lastSync | String | Last synchronization timestamp (ISO format) |
| status | String | Last sync status ("success", "failed", "conflict") |
| deviceId | String | Unique identifier for this device |
| changeHistory | Array | History of changes for conflict resolution |
| lastDeviceSync | Object | Map of device IDs to last sync timestamps |

## Indexing

While the file-based storage doesn't use traditional database indexes, the app implements the following optimization strategies:

1. **In-memory caching** of frequently accessed data
2. **Denormalized data structures** for faster access to related entities
3. **Lazy loading** of certain data components

## Data Migration

The Toast App includes a migration system to handle schema changes between versions:

1. Each version upgrade checks if migrations are needed
2. Migrations are applied sequentially based on version numbers
3. Migration history is tracked in the config store
4. Failed migrations can be retried or rolled back

## Backup and Recovery

The storage system includes backup and recovery features:

1. Automatic backups created before major changes
2. User-initiated backup/restore functionality
3. Cloud-synchronized backups for premium users
4. Recovery from corrupted data files

## Performance Considerations

To ensure optimal performance:

1. Large datasets are paginated or virtualized in the UI
2. Data is stored in separate files to minimize loading times
3. Write operations are debounced to reduce disk I/O
4. Binary data (such as custom icons) is stored outside the main config

## Schema Versioning

The storage schema uses semantic versioning:

1. Major version changes indicate backward-incompatible schema changes
2. Minor version changes indicate backward-compatible additions
3. Patch version changes indicate non-structural improvements

The current schema version is tracked in the config store to facilitate migrations when needed.
